.var_pie_chart_widget_options_component
    .hide_filter
        .container
            .input_wrapper
                toggle-button(
                    @change="switch_hide_filter" 
                    :value="hide_filter" 
                    :sync="true"
                    :width="100"
                    :labels="{checked: t('YES'), unchecked: t('NO')}" 
                )
            .input_label {{ label('var_pie_chart_widget_options_component.hide_filter') }}


    //================================================
    // SECTION 1 : WIDGET 
    //================================================
    .section
        .section-header(@click="toggleSection('widgetOptions')")
            h4 {{ label('var_pie_chart_widget_options_component.separator.widget_options') }}
            i.icon.fa-solid(:class="sectionsOpen.widgetOptions ? 'fa-caret-down' : 'fa-caret-right'")
        .section-content(v-if="sectionsOpen.widgetOptions")
            // -- BG color
            .bg_color
                .input_label {{ label("var_pie_chart_widget_options_component.bg_color") }}
                .input_wrapper
                    color-picker(
                        v-model="bg_color"
                        @change='throttled_update_colors'
                        class="bg_color_picker"
                    )

            .section
                .section-header(@click="toggleSection('chartTitle')")
                    h4 {{ label('var_pie_chart_widget_options_component.section.chart_title') }}
                    i.icon.fa-solid(:class="sectionsOpen.chartTitle ? 'fa-caret-down' : 'fa-caret-right'")
                .section-content(v-if="sectionsOpen.chartTitle")
                    
                    .field_title_display
                        .container 
                            .input_wrapper
                                toggle-button(
                                    @change="switch_title_display" 
                                    :value="title_display" 
                                    :sync="false"
                                    :width="60"
                                    :labels="{ checked: label('crud.field.boolean.true'), unchecked: label('crud.field.boolean.false') }"
                                )
                            .input_label {{ label('var_pie_chart_widget_options_component.title_display') }}

                    template(v-if='title_display')

                        // -- Titre du widget
                        .widget_title(v-if='title_name_code_text')
                            .input_label {{ label('var_pie_chart_widget_options_component.widget_title.title_name_code_text') }}
                            .input_wrapper
                                Inlinetranslatabletext(
                                    :code_text="title_name_code_text" 
                                    :is_editable="true"
                                )

                        .title_font_color
                            .input_label {{ label("var_pie_chart_widget_options_component.title_font_color") }}
                            .input_wrapper 
                                color-picker(v-model="title_font_color" @change='throttled_update_colors' class="bg_color_picker")

                        .title_font_size
                            .input_label {{ label('var_pie_chart_widget_options_component.title_font_size') }}
                            .input_wrapper
                                input(
                                    type="number"
                                    v-model="title_font_size"
                                )

                        .title_padding
                            .input_label {{ label('var_pie_chart_widget_options_component.title_padding') }}
                            .input_wrapper
                                input(
                                    type="number"
                                    v-model="title_padding"
                                )
            .section
                .section-header(@click="toggleSection('chartLegend')")
                    h4 {{ label('var_pie_chart_widget_options_component.separator.chart_legend_options') }}
                    i.icon.fa-solid(:class="sectionsOpen.chartLegend ? 'fa-caret-down' : 'fa-caret-right'")
                .section-content(v-if="sectionsOpen.chartLegend")

                    .field_legend_display
                        .container 
                            .input_wrapper
                                toggle-button(
                                    @change="switch_legend_display" 
                                    :value="legend_display" 
                                    :sync="false"
                                    :width="60"
                                    :labels="{checked: label('crud.field.boolean.true'), unchecked: label('crud.field.boolean.false')}" 
                                )
                            .input_label {{ label('var_pie_chart_widget_options_component.legend_display') }}

                    template(v-if='legend_display')
                        .legend_position 
                            .input_label {{ label('var_pie_chart_widget_options_component.legend_position') }}
                            .input_wrapper
                                multiselect.var_name_selector(
                                    :preselect-first="false"
                                    :multiple="false"
                                    v-model="tmp_selected_legend_position"
                                    :options="legend_positions"
                                    :allow-empty="false"

                                    :searchable="true"
                                    :internal-search="true"

                                    select-label=''
                                    select-group-label=''
                                    selected-label=''
                                    deselect-label=''
                                    deselect-group-label=''

                                    placeholder=''

                                    name="legend_position_selector_1"
                                )

                        .legend_font_color
                            .input_label {{ label("var_pie_chart_widget_options_component.legend_font_color") }}
                            .input_wrapper 
                                color-picker(v-model="legend_font_color" @change='throttled_update_colors' class="bg_color_picker")

                        .legend_font_size
                            .input_label {{ label('var_pie_chart_widget_options_component.legend_font_size') }}
                            .input_wrapper
                                input(
                                    type="number"
                                    v-model="legend_font_size"
                                )

                        .legend_box_width
                            .input_label {{ label('var_pie_chart_widget_options_component.legend_box_width') }}
                            .input_wrapper
                                input(
                                    type="number"
                                    v-model="legend_box_width"
                                )

                        .legend_padding
                            .input_label {{ label('var_pie_chart_widget_options_component.legend_padding') }}
                            .input_wrapper
                                input(
                                    type="number"
                                    v-model="legend_padding"
                                )

                        .field_legend_use_point_style
                            .container
                                .input_wrapper
                                    toggle-button(
                                        @change="switch_legend_use_point_style" 
                                        :value="legend_use_point_style" 
                                        :sync="false"
                                        :width="120"
                                        :labels="{checked: label('var_pie_chart_widget_options_component.legend_style.circle'), unchecked: label('var_pie_chart_widget_options_component.legend_style.rectangle')}"
                                    )
                                .input_label {{ label('var_pie_chart_widget_options_component.legend_style') }}


    //================================================
    // SECTION 4 : CHART LABEL
    //================================================
    

    //================================================
    // SECTION 6 : CHART RENDER OPTIONS
    //================================================
    .section
        .section-header(@click="toggleSection('chartLabel')")
            h4 {{ label('var_pie_chart_widget_options_component.separator.chart_options') }}
            i.icon.fa-solid(:class="sectionsOpen.chartLabel ? 'fa-caret-down' : 'fa-caret-right'")
        .section-content(v-if="sectionsOpen.chartLabel")

            .field_label_display
                .container 
                    .input_wrapper
                        toggle-button(
                            @change="switch_label_display" 
                            :value="label_display" 
                            :sync="false"
                            :width="60"
                            :labels="{ checked: label('crud.field.boolean.true'), unchecked: label('crud.field.boolean.false') }"
                        )
                    .input_label {{ label('var_pie_chart_widget_options_component.label_display') }}
            

            .cutout_percentage
                .input_label {{ label('var_pie_chart_widget_options_component.cutout_percentage') }}
                .input_wrapper
                    input(
                        type="number"
                        v-model="cutout_percentage"
                        v-tooltip="label('var_pie_chart_widget_options_component.cutout_percentage.tooltip')"
                    )

            .rotation
                .input_label {{ label('var_pie_chart_widget_options_component.rotation') }}
                .input_wrapper
                    input(
                        type="number"
                        v-model="rotation"
                        v-tooltip="label('var_pie_chart_widget_options_component.rotation.tooltip')"
                    )

            .circumference
                .input_label {{ label('var_pie_chart_widget_options_component.circumference') }}
                .input_wrapper
                    input(
                        type="number"
                        v-model="circumference"
                        v-tooltip="label('var_pie_chart_widget_options_component.circumference.tooltip')"
                    )

           
            .bg_gradient
                .container
                    .input_wrapper
                        toggle-button(
                            @change="switch_bg_gradient" 
                            :value="bg_gradient" 
                            :sync="false"
                            :width="60"
                            :labels="{checked: label('crud.field.boolean.true'), unchecked: label('crud.field.boolean.false')}" 
                        )
                    .input_label {{ label('var_pie_chart_widget_options_component.bg_gradient') }}

            template(v-if='bg_gradient')
                .bg_color_1
                    .input_label {{ label("var_pie_chart_widget_options_component.bg_color_1") }}
                    .input_wrapper
                        color-picker(v-model="bg_color_1" @change='throttled_update_colors' class="bg_color_picker")

            template(v-else)
                .input_wrapper
                    multiselect(
                        :preselect-first="false"
                        :multiple="false"
                        v-model="tmp_selected_color_palette"
                        :options="color_palettes_labels"
                        :allow-empty="false"

                        :searchable="true"
                        :internal-search="true"

                        select-label=''
                        select-group-label=''
                        selected-label=''
                        deselect-label=''
                        deselect-group-label=''

                        :placeholder="label('var_charts_options_component.color_palette_selector_placeholder')"

                        name="color_palette_selector"
                    )
            .border_color_1
                .input_label {{ label("var_pie_chart_widget_options_component.border_color_1") }}
                .input_wrapper 
                    color-picker(v-model="border_color_1" @change='throttled_update_colors' class="bg_color_picker")

            .border_width_1
                .input_label {{ label('var_pie_chart_widget_options_component.border_width_1') }}
                .input_wrapper
                    input(
                        type="number"
                        v-model="border_width_1"
                    )


    //================================================
    // SECTION 7 : DATA OPTIONS (Dimension, etc.)
    //================================================
    .section
        .section-header(@click="toggleSection('dataOptions')")
            h4 {{ label('var_pie_chart_widget_options_component.separator.datas_options') }}
            i.icon.fa-solid(:class="sectionsOpen.dataOptions ? 'fa-caret-down' : 'fa-caret-right'")
        .section-content(v-if="sectionsOpen.dataOptions")

            template(v-if='has_dimension')
                .field_dimension_is_vo_field_ref
                    .container 
                        .input_wrapper
                            toggle-button(
                                @change="switch_dimension_is_vo_field_ref" 
                                :value="dimension_is_vo_field_ref" 
                                :sync="false"
                                :width="60"
                                :labels="{ checked: label('crud.field.boolean.true'), unchecked: label('crud.field.boolean.false') }"
                            )
                        .input_label {{ label('var_pie_chart_widget_options_component.dimension_is_vo_field_ref') }}

                template(v-if='dimension_is_vo_field_ref')
                    .field_ref
                        .input_label {{ label('var_pie_chart_widget_options_component.dimension_vo_field_ref') }}
                        .input_wrapper
                            Singlevofieldrefholdercomponent(
                                :vo_field_ref="dimension_vo_field_ref"
                                @remove_field_ref="remove_dimension_vo_field_ref"
                                @add_field_ref="add_dimension_vo_field_ref"
                                :page_widget_id='page_widget ? page_widget.id : null'
                            )

                template(v-else)
                    .dimension_custom_filter_name
                        .input_label {{ label('var_pie_chart_widget_options_component.dimension_custom_filter_name') }}
                        .input_wrapper
                            .existing_custom_filters_list(v-if='get_custom_filters && get_custom_filters.length')
                                multiselect.custom_filter_selector(
                                    :preselect-first="false"
                                    :multiple="false"
                                    v-model="tmp_selected_custom_filter"
                                    :options="get_custom_filters"
                                    :allow-empty="false"
                                    :searchable="true"
                                    :internal-search="true"

                                    select-label=''
                                    select-group-label=''
                                    selected-label=''
                                    deselect-label=''
                                    deselect-group-label=''
                                    placeholder=''

                                    name="custom_filter_selector_1"
                                )

                    .dimension_custom_filter_segment_type 
                        .input_label {{ label('var_pie_chart_widget_options_component.dimension_custom_filter_segment_type') }}
                        .input_wrapper
                            multiselect.var_name_selector(
                                :preselect-first="false"
                                :multiple="false"
                                v-model="tmp_selected_dimension_custom_filter_segment_type"
                                :options="dimension_custom_filter_segment_types_values"
                                :allow-empty="false"

                                :searchable="true"
                                :internal-search="true"

                                select-label=''
                                select-group-label=''
                                selected-label=''
                                deselect-label=''
                                deselect-group-label=''

                                placeholder=''

                                name="dimension_custom_filter_segment_type_selector_1"
                            )

                .max_dimension_values
                    .input_label {{ label('var_pie_chart_widget_options_component.max_dimension_values') }}
                    .input_wrapper
                        input(
                            type="number"
                            v-model="max_dimension_values"
                            v-tooltip="label('var_pie_chart_widget_options_component.max_dimension_values.tooltip')"
                        )

                template(v-if='dimension_is_vo_field_ref')
                    .field_ref
                        .input_label {{ label('var_pie_chart_widget_options_component.sort_dimension_by_vo_field_ref') }}
                        .input_wrapper
                            Singlevofieldrefholdercomponent(
                                :vo_field_ref="sort_dimension_by_vo_field_ref"
                                @remove_field_ref="remove_sort_dimension_by_vo_field_ref"
                                @add_field_ref="add_sort_dimension_by_vo_field_ref"
                                :page_widget_id='page_widget ? page_widget.id : null'
                            )

                .field_sort_dimension_by_asc
                    .container
                        .input_wrapper
                            toggle-button(
                                @change="switch_sort_dimension_by_asc" 
                                :value="sort_dimension_by_asc" 
                                :sync="false"
                                :width="60"
                                :labels="{ checked: label('crud.field.boolean.true'), unchecked: label('crud.field.boolean.false') }"
                            )
                        .input_label {{ label('var_pie_chart_widget_options_component.sort_dimension_by_asc') }}
            .widget_filter_options(v-if='title_name_code_text && widget_options')
                .input_label {{ label('var_pie_chart_widget_options_component.widget_filter_options') }}
                .input_wrapper
                    Widgetfilteroptionscomponent(
                        :actual_additional_options="widget_options.filter_additional_params"
                        :actual_filter_type="widget_options.filter_type"
                        @update_additional_options="update_additional_options"
                        @update_filter_type="update_filter_type"
                    )
            .var_name_1 
                .input_label {{ label('var_pie_chart_widget_options_component.var_name_1') }}
                .input_wrapper
                    multiselect.var_name_selector(
                        :preselect-first="false"
                        :multiple="false"
                        v-model="tmp_selected_var_name_1"
                        :options="var_names"
                        :allow-empty="false"

                        :searchable="true"
                        :internal-search="true"

                        select-label=''
                        select-group-label=''
                        selected-label=''
                        deselect-label=''
                        deselect-group-label=''

                        placeholder=''

                        name="var_name_selector_1"
                    )
                        .lang_selector_option(slot="noOptions") -

            .var_title_1(v-if='page_widget && page_widget.id && widget_options && widget_options.var_id_1 && widget_options.get_var_name_code_text(page_widget.id, widget_options.var_id_1)')
                .input_label {{ label('var_pie_chart_widget_options_component.var_title_1.title_name_code_text') }}
                .input_wrapper
                    Inlinetranslatabletext(
                        :code_text="widget_options.get_var_name_code_text(page_widget.id, widget_options.var_id_1)" 
                        :is_editable="true"
                    )

            template(v-if='fields_that_could_get_custom_filter_1 && fields_that_could_get_custom_filter_1.length>0')
                .fields_that_could_get_custom_filter_1
                    template(v-for='field_that_could_get_custom_filter in fields_that_could_get_custom_filter_1')
                        .field_that_could_get_custom_filter
                            .field_label {{ label('var_pie_chart_widget_options_component.field_that_could_get_custom_filter') }}
                            .custom_filter 
                                input(
                                    type="text"
                                    v-model="custom_filter_names_1[field_that_could_get_custom_filter]"
                                    :disabled="true"
                                )
                            .existing_custom_filters_list(v-if='get_custom_filters && get_custom_filters.length')
                                template(v-for='custom_filter in get_custom_filters')
                                    .custom_filter.clickable(@click='change_custom_filter_1(field_that_could_get_custom_filter, custom_filter)') {{ custom_filter }}
            